name: CI/CD for Zalo Application

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Checkout the repository
      - name: Checkout repository
        uses: actions/checkout@v3

      # Step 2: Set up Node.js
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '16'

      # Step 3: Install dependencies
      - name: Install dependencies
        run: npm install vite --save dev

      # Step 4: Build the project
      - name: Build the project
        run: npm run build

      # Step 5: Deploy the application to Zalo
      - name: Deploy to Zalo
        run: |
          # Login to Zalo (ensure you have the correct app ID, secret, and refresh token)
          npx zmp-developer-token login <815485544505253554> <SC7C3EQocWcEMVUXrP2d> <ncqw4fkZU6J6RJOIdg9-PCLjCHE3xp4yY2C-6uwKD7MGCITzoAeB2yfc8HgJ_mmFlN4P7vZz80s1HGyjWFWQ0P9hJIEb-cK6lJ9f9gUz80wY7mCqavr01AeXKt7rwsvAt6b2MetmPrsiFsjglgf81BWgGIALiXOMoN05392xJncW9Gq9_u0qEC8i2oAUl3iWc3Oo0QUZBc-4R0PkggKaGQOk36-AkoL_XWK9QggCALwuHXXIv-K3OjjE75VUy5P1t5jwRDp-It_PLXnesUifSTieDLM6Yo9nfHGLSwIh65wxC1TRkVqxQeHVT7ZS-b5y-7fVMFN5TLBxHpX3zkqDQT1jE0VXsHS-krjO7B3gTJom8qeBeEvuU6ZwUaEQkNXW>
          
          # Deploy the application
          npx zmp-developer-token deploy <815485544505253554>

      # Optional: Post-deployment tasks (e.g., notifications)
      - name: Notify Deployment Success
        run: echo "Deployment to Zalo completed successfully!"
